<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>global.asax</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>global.asax</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="o">&lt;%</span><span class="err">@</span> <span class="nx">Application</span> <span class="nx">Language</span><span class="o">=</span><span class="s2">&quot;AVR&quot;</span> <span class="o">%&gt;</span>

<span class="o">&lt;</span><span class="nx">script</span> <span class="nx">runat</span><span class="o">=</span><span class="s2">&quot;server&quot;</span><span class="o">&gt;</span>

    <span class="nx">BegSr</span> <span class="nx">Application_Start</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Object</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">EventArgs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>Code that runs on application startup</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">EndSr</span>

    <span class="nx">BegSr</span> <span class="nx">Application_End</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Object</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">EventArgs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>Code that runs on application shutdown</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">EndSr</span>
        
    <span class="nx">BegSr</span> <span class="nx">Application_Error</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Object</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">EventArgs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>Code that runs when an unhandled error occurs</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">EndSr</span>

    <span class="nx">BegSr</span> <span class="nx">Session_Start</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Object</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">EventArgs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>Code that runs when a new session is started</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="nx">DclFld</span> <span class="nx">ActiveDBNameKey</span>  <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">String</span><span class="p">)</span>
        <span class="nx">DclFld</span> <span class="nx">DBName</span>        <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">String</span><span class="p">)</span> 

        <span class="nx">ActiveDBNameKey</span> <span class="o">=</span> <span class="nx">System</span><span class="p">.</span><span class="nx">Configuration</span><span class="p">.</span><span class="nx">ConfigurationManager</span><span class="p">.</span><span class="nx">AppSettings</span><span class="p">[</span><span class="s2">&quot;DefaultDBName&quot;</span><span class="p">]</span>
        <span class="nx">DBName</span> <span class="o">=</span> <span class="nx">System</span><span class="p">.</span><span class="nx">Configuration</span><span class="p">.</span><span class="nx">ConfigurationManager</span><span class="p">.</span><span class="nx">AppSettings</span><span class="p">[</span><span class="nx">ActiveDBNameKey</span><span class="p">]</span>
        <span class="nx">Session</span><span class="p">[</span><span class="s1">&#39;dbname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">DBName</span>
    <span class="nx">EndSr</span>

    <span class="nx">BegSr</span> <span class="nx">Session_End</span>
        <span class="nx">DclSrParm</span> <span class="nx">sender</span> <span class="nx">Type</span><span class="p">(</span><span class="o">*</span><span class="nb">Object</span><span class="p">)</span>
        <span class="nx">DclSrParm</span> <span class="nx">e</span> <span class="nx">Type</span><span class="p">(</span><span class="nx">EventArgs</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>Code that runs when a session ends. 
Note: The Session_End event is raised only when the sessionstate mode
is set to InProc in the Web.config file. If session mode is set to StateServer 
or SQLServer, the event is not raised.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nx">EndSr</span>

       
<span class="o">&lt;</span><span class="err">/script&gt;</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
